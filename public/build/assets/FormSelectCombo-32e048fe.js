import{m as y,u as F,Y as Ae,s as N,a1 as ve,a2 as ze,R as Oe,E as Z,r as V,K as Fe,M as L,V as we,p as de,I as ne,F as re,S as oe,W as Re,H as K,U as Ve,o as B,c as j,a as W,t as U,j as q,g as J,n as Y,l as fe,b as G,f as pe,e as $e}from"./app-fd405cde.js";import{d as ke,e as Pe,r as De,a as _e}from"./FormSelect-a0a97859.js";import{o as ue,a as he,S as Be}from"./transition-0c1806ca.js";import{u as X,o as C,w as Le,t as Ne,i as ie,f as je,E as We,b as Ue,A as le,T as ce,c as se,g as qe,N as ae,l as Ke,O as He,d as D,q as Je}from"./keyboard-e66f9111.js";import{c as $,f as me,s as Ye,u as Ge}from"./use-text-value-8586ce2a.js";import{i as Qe}from"./use-tree-walker-adf2654c.js";function Q(n,c,l){let o=l.initialDeps??[],e,a=!0;function i(){var t,m,f;let s;l.key&&((t=l.debug)!=null&&t.call(l))&&(s=Date.now());const v=n();if(!(v.length!==o.length||v.some((S,T)=>o[T]!==S)))return e;o=v;let O;if(l.key&&((m=l.debug)!=null&&m.call(l))&&(O=Date.now()),e=c(...v),l.key&&((f=l.debug)!=null&&f.call(l))){const S=Math.round((Date.now()-s)*100)/100,T=Math.round((Date.now()-O)*100)/100,k=T/16,P=(b,w)=>{for(b=String(b);b.length<w;)b=" "+b;return b};console.info(`%câ± ${P(T,5)} /${P(S,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*k,120))}deg 100% 31%);`,l==null?void 0:l.key)}return l!=null&&l.onChange&&!(a&&l.skipInitialOnChange)&&l.onChange(e),a=!1,e}return i.updateDeps=t=>{o=t},i}function be(n,c){if(n===void 0)throw new Error(`Unexpected undefined${c?`: ${c}`:""}`);return n}const Xe=(n,c)=>Math.abs(n-c)<1.01,Ze=(n,c,l)=>{let o;return function(...e){n.clearTimeout(o),o=n.setTimeout(()=>c.apply(this,e),l)}},ge=n=>{const{offsetWidth:c,offsetHeight:l}=n;return{width:c,height:l}},et=n=>n,tt=n=>{const c=Math.max(n.startIndex-n.overscan,0),l=Math.min(n.endIndex+n.overscan,n.count-1),o=[];for(let e=c;e<=l;e++)o.push(e);return o},lt=(n,c)=>{const l=n.scrollElement;if(!l)return;const o=n.targetWindow;if(!o)return;const e=i=>{const{width:t,height:m}=i;c({width:Math.round(t),height:Math.round(m)})};if(e(ge(l)),!o.ResizeObserver)return()=>{};const a=new o.ResizeObserver(i=>{const t=()=>{const m=i[0];if(m!=null&&m.borderBoxSize){const f=m.borderBoxSize[0];if(f){e({width:f.inlineSize,height:f.blockSize});return}}e(ge(l))};n.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(t):t()});return a.observe(l,{box:"border-box"}),()=>{a.unobserve(l)}},xe={passive:!0},ye=typeof window>"u"?!0:"onscrollend"in window,nt=(n,c)=>{const l=n.scrollElement;if(!l)return;const o=n.targetWindow;if(!o)return;let e=0;const a=n.options.useScrollendEvent&&ye?()=>{}:Ze(o,()=>{c(e,!1)},n.options.isScrollingResetDelay),i=s=>()=>{const{horizontal:v,isRtl:u}=n.options;e=v?l.scrollLeft*(u&&-1||1):l.scrollTop,a(),c(e,s)},t=i(!0),m=i(!1);m(),l.addEventListener("scroll",t,xe);const f=n.options.useScrollendEvent&&ye;return f&&l.addEventListener("scrollend",m,xe),()=>{l.removeEventListener("scroll",t),f&&l.removeEventListener("scrollend",m)}},ot=(n,c,l)=>{if(c!=null&&c.borderBoxSize){const o=c.borderBoxSize[0];if(o)return Math.round(o[l.options.horizontal?"inlineSize":"blockSize"])}return n[l.options.horizontal?"offsetWidth":"offsetHeight"]},it=(n,{adjustments:c=0,behavior:l},o)=>{var e,a;const i=n+c;(a=(e=o.scrollElement)==null?void 0:e.scrollTo)==null||a.call(e,{[o.options.horizontal?"left":"top"]:i,behavior:l})};class at{constructor(c){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let l=null;const o=()=>l||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:l=new this.targetWindow.ResizeObserver(e=>{e.forEach(a=>{const i=()=>{this._measureElement(a.target,a)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(i):i()})}));return{disconnect:()=>{var e;(e=o())==null||e.disconnect(),l=null},observe:e=>{var a;return(a=o())==null?void 0:a.observe(e,{box:"border-box"})},unobserve:e=>{var a;return(a=o())==null?void 0:a.unobserve(e)}}})(),this.range=null,this.setOptions=l=>{Object.entries(l).forEach(([o,e])=>{typeof e>"u"&&delete l[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:et,rangeExtractor:tt,onChange:()=>{},measureElement:ot,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...l}},this.notify=l=>{var o,e;(e=(o=this.options).onChange)==null||e.call(o,this,l)},this.maybeNotify=Q(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),l=>{this.notify(l)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(l=>l()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var l;const o=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==o){if(this.cleanup(),!o){this.maybeNotify();return}this.scrollElement=o,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((l=this.scrollElement)==null?void 0:l.window)??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,a)=>{this.scrollAdjustments=0,this.scrollDirection=a?this.getScrollOffset()<e?"forward":"backward":null,this.scrollOffset=e,this.isScrolling=a,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(l,o)=>{const e=new Map,a=new Map;for(let i=o-1;i>=0;i--){const t=l[i];if(e.has(t.lane))continue;const m=a.get(t.lane);if(m==null||t.end>m.end?a.set(t.lane,t):t.end<m.end&&e.set(t.lane,!0),e.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,t)=>i.end===t.end?i.index-t.index:i.end-t.end)[0]:void 0},this.getMeasurementOptions=Q(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(l,o,e,a,i,t)=>(this.prevLanes!==void 0&&this.prevLanes!==t&&(this.lanesChangedFlag=!0),this.prevLanes=t,this.pendingMeasuredCacheIndexes=[],{count:l,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i,lanes:t}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Q(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:l,paddingStart:o,scrollMargin:e,getItemKey:a,enabled:i,lanes:t},m)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>l)for(const u of this.laneAssignments.keys())u>=l&&this.laneAssignments.delete(u);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const f=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===l&&(this.lanesSettling=!1);const s=this.measurementsCache.slice(0,f),v=new Array(t).fill(void 0);for(let u=0;u<f;u++){const O=s[u];O&&(v[O.lane]=u)}for(let u=f;u<l;u++){const O=a(u),S=this.laneAssignments.get(u);let T,k;if(S!==void 0&&this.options.lanes>1){T=S;const z=v[T],p=z!==void 0?s[z]:void 0;k=p?p.end+this.options.gap:o+e}else{const z=this.options.lanes===1?s[u-1]:this.getFurthestMeasurement(s,u);k=z?z.end+this.options.gap:o+e,T=z?z.lane:u%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(u,T)}const P=m.get(O),b=typeof P=="number"?P:this.options.estimateSize(u),w=k+b;s[u]={index:u,start:k,size:b,end:w,key:O,lane:T},v[T]=u}return this.measurementsCache=s,s},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Q(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(l,o,e,a)=>this.range=l.length>0&&o>0?st({measurements:l,outerSize:o,scrollOffset:e,lanes:a}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Q(()=>{let l=null,o=null;const e=this.calculateRange();return e&&(l=e.startIndex,o=e.endIndex),this.maybeNotify.updateDeps([this.isScrolling,l,o]),[this.options.rangeExtractor,this.options.overscan,this.options.count,l,o]},(l,o,e,a,i)=>a===null||i===null?[]:l({startIndex:a,endIndex:i,overscan:o,count:e}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=l=>{const o=this.options.indexAttribute,e=l.getAttribute(o);return e?parseInt(e,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(l,o)=>{const e=this.indexFromElement(l),a=this.measurementsCache[e];if(!a)return;const i=a.key,t=this.elementsCache.get(i);t!==l&&(t&&this.observer.unobserve(t),this.observer.observe(l),this.elementsCache.set(i,l)),l.isConnected&&this.resizeItem(e,this.options.measureElement(l,o,this))},this.resizeItem=(l,o)=>{const e=this.measurementsCache[l];if(!e)return;const a=this.itemSizeCache.get(e.key)??e.size,i=o-a;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(e,i,this):e.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!1))},this.measureElement=l=>{if(!l){this.elementsCache.forEach((o,e)=>{o.isConnected||(this.observer.unobserve(o),this.elementsCache.delete(e))});return}this._measureElement(l,void 0)},this.getVirtualItems=Q(()=>[this.getVirtualIndexes(),this.getMeasurements()],(l,o)=>{const e=[];for(let a=0,i=l.length;a<i;a++){const t=l[a],m=o[t];e.push(m)}return e},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=l=>{const o=this.getMeasurements();if(o.length!==0)return be(o[Ce(0,o.length-1,e=>be(o[e]).start,l)])},this.getOffsetForAlignment=(l,o,e=0)=>{const a=this.getSize(),i=this.getScrollOffset();o==="auto"&&(o=l>=i+a?"end":"start"),o==="center"?l+=(e-a)/2:o==="end"&&(l-=a);const t=this.getTotalSize()+this.options.scrollMargin-a;return Math.max(Math.min(t,l),0)},this.getOffsetForIndex=(l,o="auto")=>{l=Math.max(0,Math.min(l,this.options.count-1));const e=this.measurementsCache[l];if(!e)return;const a=this.getSize(),i=this.getScrollOffset();if(o==="auto")if(e.end>=i+a-this.options.scrollPaddingEnd)o="end";else if(e.start<=i+this.options.scrollPaddingStart)o="start";else return[i,o];const t=o==="end"?e.end+this.options.scrollPaddingEnd:e.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(t,o,e.size),o]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(l,{align:o="start",behavior:e}={})=>{e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(l,o),{adjustments:void 0,behavior:e})},this.scrollToIndex=(l,{align:o="auto",behavior:e}={})=>{e==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),l=Math.max(0,Math.min(l,this.options.count-1));let a=0;const i=10,t=f=>{if(!this.targetWindow)return;const s=this.getOffsetForIndex(l,f);if(!s){console.warn("Failed to get offset for index:",l);return}const[v,u]=s;this._scrollToOffset(v,{adjustments:void 0,behavior:e}),this.targetWindow.requestAnimationFrame(()=>{const O=this.getScrollOffset(),S=this.getOffsetForIndex(l,u);if(!S){console.warn("Failed to get offset for index:",l);return}Xe(S[0],O)||m(u)})},m=f=>{this.targetWindow&&(a++,a<i?this.targetWindow.requestAnimationFrame(()=>t(f)):console.warn(`Failed to scroll to index ${l} after ${i} attempts.`))};t(o)},this.scrollBy=(l,{behavior:o}={})=>{o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+l,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var l;const o=this.getMeasurements();let e;if(o.length===0)e=this.options.paddingStart;else if(this.options.lanes===1)e=((l=o[o.length-1])==null?void 0:l.end)??0;else{const a=Array(this.options.lanes).fill(null);let i=o.length-1;for(;i>=0&&a.some(t=>t===null);){const t=o[i];a[t.lane]===null&&(a[t.lane]=t.end),i--}e=Math.max(...a.filter(t=>t!==null))}return Math.max(e-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(l,{adjustments:o,behavior:e})=>{this.options.scrollToFn(l,{behavior:e,adjustments:o},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(c)}}const Ce=(n,c,l,o)=>{for(;n<=c;){const e=(n+c)/2|0,a=l(e);if(a<o)n=e+1;else if(a>o)c=e-1;else return e}return n>0?n-1:0};function st({measurements:n,outerSize:c,scrollOffset:l,lanes:o}){const e=n.length-1,a=m=>n[m].start;if(n.length<=o)return{startIndex:0,endIndex:e};let i=Ce(0,e,a,l),t=i;if(o===1)for(;t<e&&n[t].end<l+c;)t++;else if(o>1){const m=Array(o).fill(0);for(;t<e&&m.some(s=>s<l+c);){const s=n[t];m[s.lane]=s.end,t++}const f=Array(o).fill(l+c);for(;i>=0&&f.some(s=>s>=l);){const s=n[i];f[s.lane]=s.start,i--}i=Math.max(0,i-i%o),t=Math.min(e,t+(o-1-t%o))}return{startIndex:i,endIndex:t}}function rt(n){const c=new at(F(n)),l=Ae(c),o=c._didMount();return N(()=>F(n).getScrollElement(),e=>{e&&c._willUpdate()},{immediate:!0}),N(()=>F(n),e=>{c.setOptions({...e,onChange:(a,i)=>{var t;ve(l),(t=e.onChange)==null||t.call(e,a,i)}}),c._willUpdate(),ve(l)},{immediate:!0}),ze(o),l}function ut(n){return rt(y(()=>({observeElementRect:lt,observeElementOffset:nt,scrollToFn:it,...F(n)})))}function dt(){let n=ue();return Oe(()=>n.dispose()),n}function ct(){let n=dt();return c=>{n.dispose(),n.nextFrame(c)}}var Ie=(n=>(n[n.Left=0]="Left",n[n.Right=2]="Right",n))(Ie||{});function vt(n,c){return n===c}var ft=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(ft||{}),pt=(n=>(n[n.Single=0]="Single",n[n.Multi=1]="Multi",n))(pt||{}),ht=(n=>(n[n.Pointer=0]="Pointer",n[n.Focus=1]="Focus",n[n.Other=2]="Other",n))(ht||{});let Ee=Symbol("ComboboxContext");function ee(n){let c=Re(Ee,null);if(c===null){let l=new Error(`<${n} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,ee),l}return c}let Me=Symbol("VirtualContext"),mt=Z({name:"VirtualProvider",setup(n,{slots:c}){let l=ee("VirtualProvider"),o=y(()=>{let t=C(l.optionsRef);if(!t)return{start:0,end:0};let m=window.getComputedStyle(t);return{start:parseFloat(m.paddingBlockStart||m.paddingTop),end:parseFloat(m.paddingBlockEnd||m.paddingBottom)}}),e=ut(y(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:l.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return C(l.optionsRef)},overscan:12}))),a=y(()=>{var t;return(t=l.virtual.value)==null?void 0:t.options}),i=V(0);return N([a],()=>{i.value+=1}),we(Me,l.virtual.value?e:null),()=>[ne("div",{style:{position:"relative",width:"100%",height:`${e.value.getTotalSize()}px`},ref:t=>{if(t){if(typeof process<"u"&&{}.JEST_WORKER_ID!==void 0||l.activationTrigger.value===0)return;l.activeOptionIndex.value!==null&&l.virtual.value.options.length>l.activeOptionIndex.value&&e.value.scrollToIndex(l.activeOptionIndex.value)}}},e.value.getVirtualItems().map(t=>Ve(c.default({option:l.virtual.value.options[t.index],open:l.comboboxState.value===0})[0],{key:`${i.value}-${t.index}`,"data-index":t.index,"aria-setsize":l.virtual.value.options.length,"aria-posinset":t.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${t.start}px)`,overflowAnchor:"none"}})))]}}),bt=Z({name:"Combobox",emits:{"update:modelValue":n=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(n,{slots:c,attrs:l,emit:o}){let e=V(1),a=V(null),i=V(null),t=V(null),m=V(null),f=V({static:!1,hold:!1}),s=V([]),v=V(null),u=V(2),O=V(!1);function S(r=h=>h){let h=v.value!==null?s.value[v.value]:null,g=r(s.value.slice()),x=g.length>0&&g[0].dataRef.order.value!==null?g.sort((A,_)=>A.dataRef.order.value-_.dataRef.order.value):He(g,A=>C(A.dataRef.domRef)),M=h?x.indexOf(h):null;return M===-1&&(M=null),{options:x,activeOptionIndex:M}}let T=y(()=>n.multiple?1:0),k=y(()=>n.nullable),[P,b]=ke(y(()=>n.modelValue),r=>o("update:modelValue",r),y(()=>n.defaultValue)),w=y(()=>P.value===void 0?X(T.value,{1:[],0:void 0}):P.value),z=null,p=null;function I(r){return X(T.value,{0(){return b==null?void 0:b(r)},1:()=>{let h=L(d.value.value).slice(),g=L(r),x=h.findIndex(M=>d.compare(g,L(M)));return x===-1?h.push(g):h.splice(x,1),b==null?void 0:b(h)}})}let E=y(()=>{});N([E],([r],[h])=>{if(d.virtual.value&&r&&h&&v.value!==null){let g=r.indexOf(h[v.value]);g!==-1?v.value=g:v.value=null}});let d={comboboxState:e,value:w,mode:T,compare(r,h){if(typeof n.by=="string"){let g=n.by;return(r==null?void 0:r[g])===(h==null?void 0:h[g])}return n.by===null?vt(r,h):n.by(r,h)},calculateIndex(r){return d.virtual.value?n.by===null?d.virtual.value.options.indexOf(r):d.virtual.value.options.findIndex(h=>d.compare(h,r)):s.value.findIndex(h=>d.compare(h.dataRef.value,r))},defaultValue:y(()=>n.defaultValue),nullable:k,immediate:y(()=>!1),virtual:y(()=>null),inputRef:i,labelRef:a,buttonRef:t,optionsRef:m,disabled:y(()=>n.disabled),options:s,change(r){b(r)},activeOptionIndex:y(()=>{if(O.value&&v.value===null&&(d.virtual.value?d.virtual.value.options.length>0:s.value.length>0)){if(d.virtual.value){let h=d.virtual.value.options.findIndex(g=>{var x;return!((x=d.virtual.value)!=null&&x.disabled(g))});if(h!==-1)return h}let r=s.value.findIndex(h=>!h.dataRef.disabled);if(r!==-1)return r}return v.value}),activationTrigger:u,optionsPropsRef:f,closeCombobox(){O.value=!1,!n.disabled&&e.value!==1&&(e.value=1,v.value=null)},openCombobox(){if(O.value=!0,!n.disabled&&e.value!==0){if(d.value.value){let r=d.calculateIndex(d.value.value);r!==-1&&(v.value=r)}e.value=0}},setActivationTrigger(r){u.value=r},goToOption(r,h,g){O.value=!1,z!==null&&cancelAnimationFrame(z),z=requestAnimationFrame(()=>{if(n.disabled||m.value&&!f.value.static&&e.value===1)return;if(d.virtual.value){v.value=r===$.Specific?h:me({focus:r},{resolveItems:()=>d.virtual.value.options,resolveActiveIndex:()=>{var A,_;return(_=(A=d.activeOptionIndex.value)!=null?A:d.virtual.value.options.findIndex(H=>{var te;return!((te=d.virtual.value)!=null&&te.disabled(H))}))!=null?_:null},resolveDisabled:A=>d.virtual.value.disabled(A),resolveId(){throw new Error("Function not implemented.")}}),u.value=g??2;return}let x=S();if(x.activeOptionIndex===null){let A=x.options.findIndex(_=>!_.dataRef.disabled);A!==-1&&(x.activeOptionIndex=A)}let M=r===$.Specific?h:me({focus:r},{resolveItems:()=>x.options,resolveActiveIndex:()=>x.activeOptionIndex,resolveId:A=>A.id,resolveDisabled:A=>A.dataRef.disabled});v.value=M,u.value=g??2,s.value=x.options})},selectOption(r){let h=s.value.find(x=>x.id===r);if(!h)return;let{dataRef:g}=h;I(g.value)},selectActiveOption(){if(d.activeOptionIndex.value!==null){if(d.virtual.value)I(d.virtual.value.options[d.activeOptionIndex.value]);else{let{dataRef:r}=s.value[d.activeOptionIndex.value];I(r.value)}d.goToOption($.Specific,d.activeOptionIndex.value)}},registerOption(r,h){let g=Fe({id:r,dataRef:h});if(d.virtual.value){s.value.push(g);return}p&&cancelAnimationFrame(p);let x=S(M=>(M.push(g),M));v.value===null&&d.isSelected(h.value.value)&&(x.activeOptionIndex=x.options.indexOf(g)),s.value=x.options,v.value=x.activeOptionIndex,u.value=2,x.options.some(M=>!C(M.dataRef.domRef))&&(p=requestAnimationFrame(()=>{let M=S();s.value=M.options,v.value=M.activeOptionIndex}))},unregisterOption(r,h){if(z!==null&&cancelAnimationFrame(z),h&&(O.value=!0),d.virtual.value){s.value=s.value.filter(x=>x.id!==r);return}let g=S(x=>{let M=x.findIndex(A=>A.id===r);return M!==-1&&x.splice(M,1),x});s.value=g.options,v.value=g.activeOptionIndex,u.value=2},isSelected(r){return X(T.value,{0:()=>d.compare(L(d.value.value),L(r)),1:()=>L(d.value.value).some(h=>d.compare(L(h),L(r)))})},isActive(r){return v.value===d.calculateIndex(r)}};Le([i,t,m],()=>d.closeCombobox(),y(()=>e.value===0)),we(Ee,d),Ne(y(()=>X(e.value,{0:ie.Open,1:ie.Closed})));let R=y(()=>{var r;return(r=C(i))==null?void 0:r.closest("form")});return de(()=>{N([R],()=>{if(!R.value||n.defaultValue===void 0)return;function r(){d.change(n.defaultValue)}return R.value.addEventListener("reset",r),()=>{var h;(h=R.value)==null||h.removeEventListener("reset",r)}},{immediate:!0})}),()=>{var r,h,g;let{name:x,disabled:M,form:A,..._}=n,H={open:e.value===0,disabled:M,activeIndex:d.activeOptionIndex.value,activeOption:d.activeOptionIndex.value===null?null:d.virtual.value?d.virtual.value.options[(r=d.activeOptionIndex.value)!=null?r:0]:(g=(h=d.options.value[d.activeOptionIndex.value])==null?void 0:h.dataRef.value)!=null?g:null,value:w.value};return ne(re,[...x!=null&&w.value!=null?Pe({[x]:w.value}).map(([te,Te])=>ne(je,We({features:Ue.Hidden,key:te,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:A,disabled:M,name:te,value:Te}))):[],le({theirProps:{...l,...ce(_,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:H,slots:c,attrs:l,name:"Combobox"})])}}}),gt=Z({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(n,{attrs:c,slots:l,expose:o}){var e;let a=(e=n.id)!=null?e:`headlessui-combobox-button-${se()}`,i=ee("ComboboxButton");o({el:i.buttonRef,$el:i.buttonRef});function t(s){i.disabled.value||(i.comboboxState.value===0?i.closeCombobox():(s.preventDefault(),i.openCombobox()),K(()=>{var v;return(v=C(i.inputRef))==null?void 0:v.focus({preventScroll:!0})}))}function m(s){switch(s.key){case D.ArrowDown:s.preventDefault(),s.stopPropagation(),i.comboboxState.value===1&&i.openCombobox(),K(()=>{var v;return(v=i.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return;case D.ArrowUp:s.preventDefault(),s.stopPropagation(),i.comboboxState.value===1&&(i.openCombobox(),K(()=>{i.value.value||i.goToOption($.Last)})),K(()=>{var v;return(v=i.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return;case D.Escape:if(i.comboboxState.value!==0)return;s.preventDefault(),i.optionsRef.value&&!i.optionsPropsRef.value.static&&s.stopPropagation(),i.closeCombobox(),K(()=>{var v;return(v=i.inputRef.value)==null?void 0:v.focus({preventScroll:!0})});return}}let f=Ye(y(()=>({as:n.as,type:c.type})),i.buttonRef);return()=>{var s,v;let u={open:i.comboboxState.value===0,disabled:i.disabled.value,value:i.value.value},{...O}=n,S={ref:i.buttonRef,id:a,type:f.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(s=C(i.optionsRef))==null?void 0:s.id,"aria-expanded":i.comboboxState.value===0,"aria-labelledby":i.labelRef.value?[(v=C(i.labelRef))==null?void 0:v.id,a].join(" "):void 0,disabled:i.disabled.value===!0?!0:void 0,onKeydown:m,onClick:t};return le({ourProps:S,theirProps:O,slot:u,attrs:c,slots:l,name:"ComboboxButton"})}}}),xt=Z({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:n=>!0},setup(n,{emit:c,attrs:l,slots:o,expose:e}){var a;let i=(a=n.id)!=null?a:`headlessui-combobox-input-${se()}`,t=ee("ComboboxInput"),m=y(()=>qe(C(t.inputRef))),f={value:!1};e({el:t.inputRef,$el:t.inputRef});function s(){t.change(null);let p=C(t.optionsRef);p&&(p.scrollTop=0),t.goToOption($.Nothing)}let v=y(()=>{var p;let I=t.value.value;return C(t.inputRef)?typeof n.displayValue<"u"&&I!==void 0?(p=n.displayValue(I))!=null?p:"":typeof I=="string"?I:"":""});de(()=>{N([v,t.comboboxState,m],([p,I],[E,d])=>{if(f.value)return;let R=C(t.inputRef);R&&((d===0&&I===1||p!==E)&&(R.value=p),requestAnimationFrame(()=>{var r;if(f.value||!R||((r=m.value)==null?void 0:r.activeElement)!==R)return;let{selectionStart:h,selectionEnd:g}=R;Math.abs((g??0)-(h??0))===0&&h===0&&R.setSelectionRange(R.value.length,R.value.length)}))},{immediate:!0}),N([t.comboboxState],([p],[I])=>{if(p===0&&I===1){if(f.value)return;let E=C(t.inputRef);if(!E)return;let d=E.value,{selectionStart:R,selectionEnd:r,selectionDirection:h}=E;E.value="",E.value=d,h!==null?E.setSelectionRange(R,r,h):E.setSelectionRange(R,r)}})});let u=V(!1);function O(){u.value=!0}function S(){ue().nextFrame(()=>{u.value=!1})}let T=ct();function k(p){switch(f.value=!0,T(()=>{f.value=!1}),p.key){case D.Enter:if(f.value=!1,t.comboboxState.value!==0||u.value)return;if(p.preventDefault(),p.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case D.ArrowDown:return f.value=!1,p.preventDefault(),p.stopPropagation(),X(t.comboboxState.value,{0:()=>t.goToOption($.Next),1:()=>t.openCombobox()});case D.ArrowUp:return f.value=!1,p.preventDefault(),p.stopPropagation(),X(t.comboboxState.value,{0:()=>t.goToOption($.Previous),1:()=>{t.openCombobox(),K(()=>{t.value.value||t.goToOption($.Last)})}});case D.Home:if(p.shiftKey)break;return f.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption($.First);case D.PageUp:return f.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption($.First);case D.End:if(p.shiftKey)break;return f.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption($.Last);case D.PageDown:return f.value=!1,p.preventDefault(),p.stopPropagation(),t.goToOption($.Last);case D.Escape:if(f.value=!1,t.comboboxState.value!==0)return;p.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&p.stopPropagation(),t.nullable.value&&t.mode.value===0&&t.value.value===null&&s(),t.closeCombobox();break;case D.Tab:if(f.value=!1,t.comboboxState.value!==0)return;t.mode.value===0&&t.activationTrigger.value!==1&&t.selectActiveOption(),t.closeCombobox();break}}function P(p){c("change",p),t.nullable.value&&t.mode.value===0&&p.target.value===""&&s(),t.openCombobox()}function b(p){var I,E,d;let R=(I=p.relatedTarget)!=null?I:he.find(r=>r!==p.currentTarget);if(f.value=!1,!((E=C(t.optionsRef))!=null&&E.contains(R))&&!((d=C(t.buttonRef))!=null&&d.contains(R))&&t.comboboxState.value===0)return p.preventDefault(),t.mode.value===0&&(t.nullable.value&&t.value.value===null?s():t.activationTrigger.value!==1&&t.selectActiveOption()),t.closeCombobox()}function w(p){var I,E,d;let R=(I=p.relatedTarget)!=null?I:he.find(r=>r!==p.currentTarget);(E=C(t.buttonRef))!=null&&E.contains(R)||(d=C(t.optionsRef))!=null&&d.contains(R)||t.disabled.value||t.immediate.value&&t.comboboxState.value!==0&&(t.openCombobox(),ue().nextFrame(()=>{t.setActivationTrigger(1)}))}let z=y(()=>{var p,I,E,d;return(d=(E=(I=n.defaultValue)!=null?I:t.defaultValue.value!==void 0?(p=n.displayValue)==null?void 0:p.call(n,t.defaultValue.value):null)!=null?E:t.defaultValue.value)!=null?d:""});return()=>{var p,I,E,d,R,r,h;let g={open:t.comboboxState.value===0},{displayValue:x,onChange:M,...A}=n,_={"aria-controls":(p=t.optionsRef.value)==null?void 0:p.id,"aria-expanded":t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null?void 0:t.virtual.value?(I=t.options.value.find(H=>!t.virtual.value.disabled(H.dataRef.value)&&t.compare(H.dataRef.value,t.virtual.value.options[t.activeOptionIndex.value])))==null?void 0:I.id:(E=t.options.value[t.activeOptionIndex.value])==null?void 0:E.id,"aria-labelledby":(r=(d=C(t.labelRef))==null?void 0:d.id)!=null?r:(R=C(t.buttonRef))==null?void 0:R.id,"aria-autocomplete":"list",id:i,onCompositionstart:O,onCompositionend:S,onKeydown:k,onInput:P,onFocus:w,onBlur:b,role:"combobox",type:(h=l.type)!=null?h:"text",tabIndex:0,ref:t.inputRef,defaultValue:z.value,disabled:t.disabled.value===!0?!0:void 0};return le({ourProps:_,theirProps:A,slot:g,attrs:l,slots:o,features:ae.RenderStrategy|ae.Static,name:"ComboboxInput"})}}}),yt=Z({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(n,{attrs:c,slots:l,expose:o}){let e=ee("ComboboxOptions"),a=`headlessui-combobox-options-${se()}`;o({el:e.optionsRef,$el:e.optionsRef}),oe(()=>{e.optionsPropsRef.value.static=n.static}),oe(()=>{e.optionsPropsRef.value.hold=n.hold});let i=Ke(),t=y(()=>i!==null?(i.value&ie.Open)===ie.Open:e.comboboxState.value===0);Qe({container:y(()=>C(e.optionsRef)),enabled:y(()=>e.comboboxState.value===0),accept(f){return f.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:f.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(f){f.setAttribute("role","none")}});function m(f){f.preventDefault()}return()=>{var f,s,v;let u={open:e.comboboxState.value===0},O={"aria-labelledby":(v=(f=C(e.labelRef))==null?void 0:f.id)!=null?v:(s=C(e.buttonRef))==null?void 0:s.id,id:a,ref:e.optionsRef,role:"listbox","aria-multiselectable":e.mode.value===1?!0:void 0,onMousedown:m},S=ce(n,["hold"]);return le({ourProps:O,theirProps:S,slot:u,attrs:c,slots:e.virtual.value&&e.comboboxState.value===0?{...l,default:()=>[ne(mt,{},l.default)]}:l,features:ae.RenderStrategy|ae.Static,visible:t.value,name:"ComboboxOptions"})}}}),Se=Z({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(n,{slots:c,attrs:l,expose:o}){let e=ee("ComboboxOption"),a=`headlessui-combobox-option-${se()}`,i=V(null),t=y(()=>n.disabled);o({el:i,$el:i});let m=y(()=>{var b;return e.virtual.value?e.activeOptionIndex.value===e.calculateIndex(n.value):e.activeOptionIndex.value===null?!1:((b=e.options.value[e.activeOptionIndex.value])==null?void 0:b.id)===a}),f=y(()=>e.isSelected(n.value)),s=Re(Me,null),v=y(()=>({disabled:n.disabled,value:n.value,domRef:i,order:y(()=>n.order)}));de(()=>e.registerOption(a,v)),Oe(()=>e.unregisterOption(a,m.value)),oe(()=>{let b=C(i);b&&(s==null||s.value.measureElement(b))}),oe(()=>{e.comboboxState.value===0&&m.value&&(e.virtual.value||e.activationTrigger.value!==0&&K(()=>{var b,w;return(w=(b=C(i))==null?void 0:b.scrollIntoView)==null?void 0:w.call(b,{block:"nearest"})}))});function u(b){b.preventDefault(),b.button===Ie.Left&&(t.value||(e.selectOption(a),Je()||requestAnimationFrame(()=>{var w;return(w=C(e.inputRef))==null?void 0:w.focus({preventScroll:!0})}),e.mode.value===0&&e.closeCombobox()))}function O(){var b;if(n.disabled||(b=e.virtual.value)!=null&&b.disabled(n.value))return e.goToOption($.Nothing);let w=e.calculateIndex(n.value);e.goToOption($.Specific,w)}let S=Ge();function T(b){S.update(b)}function k(b){var w;if(!S.wasMoved(b)||n.disabled||(w=e.virtual.value)!=null&&w.disabled(n.value)||m.value)return;let z=e.calculateIndex(n.value);e.goToOption($.Specific,z,0)}function P(b){var w;S.wasMoved(b)&&(n.disabled||(w=e.virtual.value)!=null&&w.disabled(n.value)||m.value&&(e.optionsPropsRef.value.hold||e.goToOption($.Nothing)))}return()=>{let{disabled:b}=n,w={active:m.value,selected:f.value,disabled:b},z={id:a,ref:i,role:"option",tabIndex:b===!0?void 0:-1,"aria-disabled":b===!0?!0:void 0,"aria-selected":f.value,disabled:void 0,onMousedown:u,onFocus:O,onPointerenter:T,onMouseenter:T,onPointermove:k,onMousemove:k,onPointerleave:P,onMouseleave:P},p=ce(n,["order","value"]);return le({ourProps:z,theirProps:p,slot:w,attrs:l,slots:c,name:"ComboboxOption"})}}});const St={for:"name",class:"block text-sm leading-6 text-gray-900"},Ot={class:"relative"},wt={key:0,class:"relative cursor-default select-none py-2 px-4 text-gray-700"},Rt={key:1,class:"relative cursor-default select-none py-2 px-4 text-gray-700"},Ct={key:0,class:"form-error text-[#b91c1c] text-xs"},Ft={__name:"FormSelectCombo",props:{modelValue:Object,name:String,className:String,placeholder:{type:String,default:"Select option"},options:{type:Array,default:()=>[]},loadOptions:Function,createOption:Function,error:String},emits:["update:modelValue"],setup(n,{emit:c}){const l=c,o=n,e=V([]),a=V(!1),i=y(()=>t.value===""?null:{missing:!0,label:t.value});let t=V("");N(t,s=>{o.loadOptions&&(a.value=!0,o.loadOptions(s,v=>{e.value=Object.values(v).map(u=>({value:u.id,label:`${u.first_name} ${u.last_name}`})),a.value=!1}))},{immediate:!0});let m=y(()=>t.value===""?e.value:e.value.filter(s=>s.label.toLowerCase().replace(/\s+/g,"").includes(t.value.toLowerCase().replace(/\s+/g,""))));function f(s){l("update:modelValue",s),o.createOption&&(s!=null&&s.missing)&&(a.value=!0,o.createOption(s,v=>{l("update:modelValue",v),a.value=!1}))}return(s,v)=>(B(),j("div",{class:Y(n.className)},[W("label",St,U(n.name),1),W("div",null,[q(F(bt),{by:"value","model-value":o.modelValue,"onUpdate:modelValue":f},{default:J(()=>[W("div",Ot,[W("div",{class:Y(["relative w-full cursor-default overflow-hidden rounded-lg bg-white text-left ring-1 shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 focus-visible:ring-offset-2 focus-visible:ring-offset-teal-300 sm:text-sm",n.error?"ring-[#b91c1c]":"ring-gray-300"])},[q(F(xt),{class:"w-full border-none py-2 pl-3 pr-10 text-sm leading-5 text-gray-900 focus:outline-none focus:ring-0",displayValue:u=>u==null?void 0:u.label,onChange:v[0]||(v[0]=u=>fe(t)?t.value=u.target.value:t=u.target.value)},null,8,["displayValue"]),q(F(gt),{class:"absolute inset-y-0 right-0 flex items-center pr-2"},{default:J(()=>[q(F(De),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),_:1})],2),q(F(Be),{leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",onAfterLeave:v[1]||(v[1]=u=>fe(t)?t.value="":t="")},{default:J(()=>[q(F(yt),{class:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:J(()=>[F(m).length===0&&!a.value&&!i.value&&!o.createOption?(B(),j("div",wt,U(s.$t("Nothing found")),1)):G("",!0),a.value?(B(),j("div",Rt,U(s.$t("Loading...")),1)):G("",!0),a.value?G("",!0):(B(),j(re,{key:2},[i.value&&!F(m).length&&o.createOption?(B(),pe(F(Se),{key:0,as:"template",value:i.value},{default:J(({active:u})=>[W("li",{class:Y(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-teal-600 text-white":u,"text-gray-900":!u}])},U(s.$t("Create"))+' "'+U(i.value.label)+'" ',3)]),_:1},8,["value"])):G("",!0),(B(!0),j(re,null,$e(F(m),u=>(B(),pe(F(Se),{as:"template",key:u.value,value:u},{default:J(({selected:O,active:S})=>[W("li",{class:Y(["relative cursor-default select-none py-2 pl-10 pr-4",{"bg-teal-600 text-white":S,"text-gray-900":!S}])},[W("span",{class:Y(["block truncate",{"font-medium":O,"font-normal":!O}])},U(u.label),3),O?(B(),j("span",{key:0,class:Y(["absolute inset-y-0 left-0 flex items-center pl-3",{"text-white":S,"text-teal-600":!S}])},[q(F(_e),{class:"h-5 w-5","aria-hidden":"true"})],2)):G("",!0)],2)]),_:2},1032,["value"]))),128))],64))]),_:1})]),_:1})])]),_:1},8,["model-value"])]),n.error?(B(),j("div",Ct,U(n.error),1)):G("",!0)],2))}};export{Ft as _};
