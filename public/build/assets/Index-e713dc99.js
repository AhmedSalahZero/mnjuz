import z from"./App-a9d04c5a.js";import{r as w,T as F,s as V,o as u,f as R,g as l,a as e,c as h,t as s,h as b,k as N,j as o,u as d,n as L,b as O,N as B,w as Z,v as E,d as q,F as D,e as H,l as I,i as P}from"./app-fd405cde.js";import{d as G}from"./debounce-8c1522e2.js";import{_ as J}from"./AlertModal-9fb23213.js";import{u as K}from"./useAlertModal-8eb06a6d.js";import{_ as Q}from"./Modal-1afee7e0.js";import{F as W}from"./FormSelect-a0a97859.js";/* empty css              */import{_ as X}from"./Table-e1ecbfa7.js";import{T as Y,a as ee,_ as j}from"./TableHeaderRowItem-3c09f4bd.js";import{T as te,a as se,_ as M}from"./TableBodyRowItem-4093d939.js";import{_ as oe}from"./Dropdown-a54f1397.js";import{_ as re,a as A}from"./DropdownItem-9add4917.js";import"./useRtl-fae40199.js";import"./index-0950efc1.js";import"./MobileSidebar-f5b35097.js";import"./FormInput-d741bf78.js";import"./ProfileModal-0b4fa056.js";import"./FormPhoneInput-bcbb9536.js";import"./transition-0c1806ca.js";import"./keyboard-e66f9111.js";import"./use-text-value-8586ce2a.js";import"./Sidebar-1156c647.js";import"./Menu-683dace0.js";import"./_baseGetTag-4e76049f.js";import"./Pagination-ae2ecc0d.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-tree-walker-adf2654c.js";const le={class:"mt-5"},ae={key:0,class:"flex justify-center items-center py-8"},ne={key:1},ie={class:"mb-4 p-2 bg-yellow-50 border border-yellow-200 rounded-md"},de={class:"flex"},ue={class:"ml-3"},me={class:"text-sm font-medium text-yellow-800"},ce={class:"mt-2 text-sm text-yellow-700"},fe={class:"mb-4"},pe={class:"text-sm font-medium text-gray-900 mb-2"},be={class:"p-3 bg-gray-50 rounded-md"},he={class:"font-medium"},ve={class:"mb-4"},ge={class:"block text-sm font-medium text-gray-700 mb-2"},we={class:"flex justify-end space-x-3"},_e=["disabled"],ye={key:0},xe={key:1},$e={key:2},ke={class:"text-center py-8"},Ce={class:"text-lg font-medium text-gray-900 mb-2"},Te={class:"text-gray-600 mb-4"},Ue={class:"flex justify-center space-x-3"},Ne=["disabled"],je={__name:"RoleTransferModal",props:{isOpen:{type:Boolean,default:!1},roleUuid:{type:String,default:null}},emits:["close","deleted"],setup(v,{emit:$}){const a=v,f=$,k=w(!1),_=w({has_users:!1}),g=w(!1),n=F({new_role:null}),C=w([]),T=async()=>{if(a.roleUuid){k.value=!0;try{const i=await(await fetch(`/admin/team/roles/${a.roleUuid}/check-users`)).json();_.value=i,i.has_users&&i.available_roles&&(C.value=i.available_roles.map(x=>({value:x.uuid,label:x.name})))}catch(t){console.error("Error checking users:",t)}finally{k.value=!1}}},U=()=>{n.new_role&&n.post(`/admin/team/roles/${a.roleUuid}/destroy-with-transfer`,{onSuccess:()=>{f("deleted"),p()}})},y=()=>{n.delete(`/admin/team/roles/${a.roleUuid}`,{onSuccess:()=>{f("deleted"),p()}})},p=()=>{g.value=!0,n.reset(),n.clearErrors(),_.value={has_users:!1},C.value=[],f("close")};return V(()=>a.roleUuid,t=>{t&&a.isOpen&&T()}),V(()=>a.isOpen,t=>{t&&a.roleUuid&&(g.value=!1,T())}),(t,i)=>(u(),R(Q,{label:t.$t("Transfer Users"),isOpen:v.isOpen,onClose:p},{default:l(()=>[e("div",le,[k.value?(u(),h("div",ae,[...i[1]||(i[1]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1)])])):!g.value&&_.value.has_users?(u(),h("div",ne,[e("div",ie,[e("div",de,[e("div",ue,[e("h3",me,s(t.$t("Users Found")),1),e("div",ce,[e("p",null,[b(s(t.$t("This role has"))+" ",1),e("strong",null,s(_.value.user_count),1),b(" "+s(t.$t("users"))+". "+s(t.$t("Please select a role to transfer them to before deleting this role"))+".",1)])])])])]),e("div",fe,[e("h4",pe,s(t.$t("Current Role"))+":",1),e("div",be,[e("div",he,s(_.value.role.name),1)])]),e("form",{onSubmit:N(U,["prevent"])},[e("div",ve,[e("label",ge,s(t.$t("Transfer users to"))+": ",1),o(W,{modelValue:d(n).new_role,"onUpdate:modelValue":i[0]||(i[0]=x=>d(n).new_role=x),name:t.$t("Select Role"),error:d(n).errors.new_role,options:C.value,class:L("w-full"),dropdownUp:!0,required:""},null,8,["modelValue","name","error","options"])]),e("div",we,[e("button",{type:"button",onClick:N(p,["prevent"]),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},s(t.$t("Cancel")),1),e("button",{type:"submit",disabled:d(n).processing||!d(n).new_role,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed"},[d(n).processing?(u(),h("span",ye,s(t.$t("Transferring...")),1)):(u(),h("span",xe,s(t.$t("Transfer & Delete Role")),1))],8,_e)])],32)])):g.value?O("",!0):(u(),h("div",$e,[e("div",ke,[i[2]||(i[2]=e("div",{class:"text-green-600 mb-2"},[e("svg",{class:"mx-auto h-12 w-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("h3",Ce,s(t.$t("No Users")),1),e("p",Te,s(t.$t("This role has no users and can be safely deleted"))+".",1),e("div",Ue,[e("button",{type:"button",onClick:N(p,["prevent"]),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},s(t.$t("Cancel")),1),e("button",{onClick:y,disabled:d(n).processing,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50"},s(t.$t("Delete Role")),9,Ne)])])]))])]),_:1},8,["label","isOpen"]))}},Me={class:"md:bg-white flex items-center border border-primary md:border-none md:shadow-sm h-12 md:h-10 w-full md:w-80 rounded-[0.5rem] mb-6 text-xl md:text-sm"},Oe=["placeholder"],Re={key:1,class:"pr-2"},Se={__name:"RoleTable",props:{rows:{type:Object,required:!0},filters:{type:Object}},emits:["delete"],setup(v,{emit:$}){const a=v,{isOpenAlert:f,openAlert:k,confirmAlert:_}=K();F({test:null});const g=w(!1),n=w(null),C=m=>{n.value=m,g.value=!0},T=()=>{B.reload()},U=m=>m===a.rows.data.length-1,y=w({search:a.filters.search}),p=w(!1),t=()=>{y.value.search=null,x()},i=G(()=>{p.value=!0,x()},1e3),x=()=>{B.visit("/admin/team/roles",{method:"get",data:y.value})};return(m,r)=>(u(),h(D,null,[e("div",Me,[r[7]||(r[7]=e("span",{class:"pl-3"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m15 15l6 6m-11-4a7 7 0 1 1 0-14a7 7 0 0 1 0 14Z"})])],-1)),Z(e("input",{onInput:r[0]||(r[0]=(...c)=>d(i)&&d(i)(...c)),"onUpdate:modelValue":r[1]||(r[1]=c=>y.value.search=c),type:"text",class:"outline-none px-4 w-full",placeholder:m.$t("Search roles")},null,40,Oe),[[E,y.value.search]]),p.value===!1&&y.value.search?(u(),h("button",{key:0,onClick:t,type:"button",class:"pr-2"},[...r[5]||(r[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10s10-4.5 10-10S17.5 2 12 2zm3.7 12.3c.4.4.4 1 0 1.4c-.4.4-1 .4-1.4 0L12 13.4l-2.3 2.3c-.4.4-1 .4-1.4 0c-.4-.4-.4-1 0-1.4l2.3-2.3l-2.3-2.3c-.4-.4-.4-1 0-1.4c.4-.4 1-.4 1.4 0l2.3 2.3l2.3-2.3c.4-.4 1-.4 1.4 0c.4.4.4 1 0 1.4L13.4 12l2.3 2.3z"})],-1)])])):O("",!0),p.value?(u(),h("span",Re,[...r[6]||(r[6]=[q('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="0 12 12;90 12 12;180 12 12;270 12 12"></animateTransform><animate attributeName="opacity" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" begin="0.2s" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="30 12 12;120 12 12;210 12 12;300 12 12"></animateTransform><animate attributeName="opacity" begin="0.2s" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle><circle cx="12" cy="3.5" r="1.5" fill="currentColor" opacity="0"><animateTransform attributeName="transform" begin="0.4s" calcMode="discrete" dur="2.4s" repeatCount="indefinite" type="rotate" values="60 12 12;150 12 12;240 12 12;330 12 12"></animateTransform><animate attributeName="opacity" begin="0.4s" dur="0.6s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1;1;0"></animate></circle></svg>',1)])])):O("",!0)]),o(X,{rows:v.rows},{default:l(()=>[o(Y,null,{default:l(()=>[o(ee,null,{default:l(()=>[o(j,{position:"first"},{default:l(()=>[b(s(m.$t("Name")),1)]),_:1}),o(j,null,{default:l(()=>[b(s(m.$t("Last updated")),1)]),_:1}),o(j,{position:"last"})]),_:1})]),_:1}),o(te,null,{default:l(()=>[(u(!0),h(D,null,H(v.rows.data,(c,S)=>(u(),R(se,{key:S,class:L(U(S)?"":"border-b")},{default:l(()=>[o(M,{position:"first",class:"capitalize"},{default:l(()=>[b(s(c.name),1)]),_:2},1024),o(M,{class:"hidden sm:table-cell"},{default:l(()=>[b(s(c.updated_at),1)]),_:2},1024),o(M,{position:"last"},{default:l(()=>[o(oe,{align:"right",class:"mt-2"},{items:l(()=>[o(re,null,{default:l(()=>[o(A,{href:"/admin/team/roles/"+c.uuid},{default:l(()=>[b(s(m.$t("View/edit")),1)]),_:1},8,["href"]),o(A,{as:"button",onClick:Le=>d(k)(c.uuid)},{default:l(()=>[b(s(m.$t("Delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[r[8]||(r[8]=e("button",{class:"inline-flex w-full justify-center rounded-md text-sm font-medium text-black hover:bg-opacity-30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"},[e("span",{class:"hover:bg-[#F6F7F9] hover:rounded-full w-[fit-content] p-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 16a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2Z"})])])],-1))]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1},8,["rows"]),o(J,{modelValue:d(f),"onUpdate:modelValue":r[2]||(r[2]=c=>I(f)?f.value=c:null),onConfirm:r[3]||(r[3]=()=>d(_)(C)),label:m.$t("Delete row"),description:m.$t("Are you sure you want to delete this row? This action can not be undone")},null,8,["modelValue","label","description"]),o(je,{isOpen:g.value,roleUuid:n.value,onClose:r[4]||(r[4]=c=>g.value=!1),onDeleted:T},null,8,["isOpen","roleUuid"])],64))}},Ve={class:"bg-white md:bg-inherit pt-10 px-4 md:pt-8 md:p-8 rounded-[5px] text-[#000] h-full md:overflow-y-auto"},Be={class:"flex justify-between"},De={class:"text-xl mb-1"},Ae={class:"mb-6 flex items-center text-sm leading-6 text-gray-600"},Fe={class:"ml-1 mt-1"},pt={__name:"Index",props:{title:String,rows:Object,filters:Object},setup(v){const $=v;return(a,f)=>(u(),R(z,null,{default:l(()=>[e("div",Ve,[e("div",Be,[e("div",null,[e("h1",De,s(a.$t("Admin roles")),1),e("p",Ae,[f[0]||(f[0]=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 11v5m0 5a9 9 0 1 1 0-18a9 9 0 0 1 0 18Zm.05-13v.1h-.1V8h.1Z"})],-1)),e("span",Fe,s(a.$t("Manage roles")),1)])]),e("div",null,[o(d(P),{href:"/admin/team/roles/create",class:"rounded-md bg-indigo-600 px-3 py-2 text-sm text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},{default:l(()=>[b(s(a.$t("Add role")),1)]),_:1})])]),o(Se,{rows:$.rows,filters:$.filters},null,8,["rows","filters"])])]),_:1}))}};export{pt as default};
