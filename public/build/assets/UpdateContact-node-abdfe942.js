import{W as D,m as i,r as K,K as O,c as d,j as o,u as n,a as e,d as Z,t as g,h as f,n as q,k as G,b as x,o as r}from"./app-b42f2b4d.js";import{u as J,b as Q,c as j,d as B}from"./vue-flow-core-728dded2.js";import{F as R}from"./FormSelect-530d03f0.js";import{_ as X}from"./FormCheckbox-58df961f.js";import{F as Y}from"./FormTextArea-da42eb43.js";import{_ as ee}from"./_plugin-vue_export-helper-c27b6911.js";import"./keyboard-b8310384.js";import"./use-text-value-24dee2a5.js";const te={class:"update-contact-node"},se={class:"bg-white border-2 border-teal-200 rounded-lg p-4 shadow-sm w-[400px]",style:{"min-width":"400px"}},ae={class:"flex items-center mb-3"},le={class:"flex items-center gap-2 flex-1"},oe={class:"font-medium text-gray-900 text-sm"},ie={class:"text-xs text-gray-600 mb-2"},de={class:"flex items-center justify-between text-xs"},ne={class:"flex items-center gap-1"},re={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ce={class:"bg-white rounded-lg max-w-md w-full mx-4 max-h-[80vh] overflow-y-auto"},me={class:"space-y-4"},ue={class:"space-y-3"},ve={class:"space-y-4"},pe={class:"space-y-3"},ge={key:0,class:"space-y-3"},fe={class:"bg-gray-50 border border-blue-200 rounded-lg p-3"},xe={class:"text-sm text-blue-800"},be={key:0,class:"text-xs text-orange-600 mt-2"},ye={class:"flex items-center"},he={__name:"UpdateContact-node",props:{id:String,data:Object,selected:Boolean},setup(z){const c=z,{removeNodes:I}=J(),b=Q(),$=D("contactFields",[]),m=i(()=>{var s;return((s=c.data)==null?void 0:s.config)||{}}),u=i(()=>{var s;return((s=c.data)==null?void 0:s.is_active)!==!1}),v=K(!1),p=i(()=>{const s=[];return s.push({value:"first_name",label:"First Name"},{value:"last_name",label:"Last Name"},{value:"email",label:"Email"}),s.push({value:"address.street",label:"Street"},{value:"address.city",label:"City"},{value:"address.state",label:"State"},{value:"address.zip",label:"Zip Code"},{value:"address.country",label:"Country"}),$.forEach(t=>{s.push({value:`metadata.${t.name}`,label:t.name})}),s}),H=i(()=>{const s=m.value;if(s.target_field){const t=p.value.find(l=>l.value===s.target_field);return t?`Update Contact: ${t.label}`:`Update Contact: ${s.target_field}`}return"Update Contact"}),a=O({config:{},is_active:!0}),T=s=>{if(!s)return"No field selected";const t=p.value.find(l=>l.value===s);return t?t.label:s},L=()=>{var t,l,h,_,w,C,k,N,V,F,E,M,U,A,S;const s=m.value||{};a.config={...s,target_field:s.target_field||"",invalid_email_message:s.invalid_email_message||"Please provide a valid email address.",fields:{first_name:((t=s.fields)==null?void 0:t.first_name)||"",last_name:((l=s.fields)==null?void 0:l.last_name)||"",email:((h=s.fields)==null?void 0:h.email)||"",phone:((_=s.fields)==null?void 0:_.phone)||"",address:{street:((C=(w=s.fields)==null?void 0:w.address)==null?void 0:C.street)||"",city:((N=(k=s.fields)==null?void 0:k.address)==null?void 0:N.city)||"",state:((F=(V=s.fields)==null?void 0:V.address)==null?void 0:F.state)||"",zip:((M=(E=s.fields)==null?void 0:E.address)==null?void 0:M.zip)||"",country:((A=(U=s.fields)==null?void 0:U.address)==null?void 0:A.country)||""},metadata:((S=s.fields)==null?void 0:S.metadata)||{}}},a.is_active=u.value,v.value=!0},y=()=>{v.value=!1},P=()=>{b.node.data={...b.node.data,config:a.config,is_active:a.is_active},y()},W=()=>{confirm("Are you sure you want to delete this action?")&&I([c.id])};return(s,t)=>(r(),d("div",te,[o(n(B),{type:"target",position:n(j).Top,class:"w-3 h-3 !bg-teal-500"},null,8,["position"]),e("div",se,[e("div",ae,[e("div",le,[t[3]||(t[3]=Z('<div class="w-8 h-8 bg-slate-50 rounded-lg flex items-center justify-center" data-v-b80a6774><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-teal-600" data-v-b80a6774><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" data-v-b80a6774></path><circle cx="9" cy="7" r="4" data-v-b80a6774></circle><path d="m16 3 4 4-4 4" data-v-b80a6774></path><path d="M20 7H4" data-v-b80a6774></path></svg></div>',1)),e("div",null,[e("h3",oe,g(H.value),1)])]),e("div",{class:"flex items-center gap-1 ml-auto"},[e("button",{onClick:L,class:"p-1 text-gray-400 hover:text-gray-600 rounded",title:"Edit Action"},[...t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])]),e("button",{onClick:W,class:"p-1 text-red-400 hover:text-red-600 rounded",title:"Delete Action"},[...t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})],-1)])])])]),e("div",ie,[e("div",null,[t[6]||(t[6]=e("span",{class:"font-medium"},"Update field:",-1)),f(" "+g(T(m.value.target_field)),1)])]),e("div",de,[t[7]||(t[7]=e("span",{class:"text-gray-500"},"Action",-1)),e("div",ne,[e("span",{class:q([u.value?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 py-1 rounded-full text-xs"])},g(u.value?"Active":"Inactive"),3)])])]),o(n(B),{type:"source",position:n(j).Bottom,class:"w-3 h-3 !bg-teal-500"},null,8,["position"]),v.value?(r(),d("div",re,[e("div",ce,[t[16]||(t[16]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Edit Update Contact Action")],-1)),e("form",{onSubmit:G(P,["prevent"]),class:"p-6"},[e("div",me,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Configuration",-1)),e("div",ue,[e("div",null,[e("div",ve,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700"},"Save User's Message to Contact Field",-1)),e("div",pe,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Select Contact Field",-1)),o(R,{modelValue:a.config.target_field,"onUpdate:modelValue":t[0]||(t[0]=l=>a.config.target_field=l),options:p.value,placeholder:"Choose which field to update"},null,8,["modelValue","options"])])]),a.config.target_field==="email"?(r(),d("div",ge,[e("div",null,[o(Y,{modelValue:a.config.invalid_email_message,"onUpdate:modelValue":t[1]||(t[1]=l=>a.config.invalid_email_message=l),name:"Invalid Email Message",rows:"3",placeholder:"Please provide a valid email address."},null,8,["modelValue"]),t[9]||(t[9]=e("p",{class:"text-xs text-gray-500 mt-1"}," Message to send when user provides an invalid email format. Leave empty to use default message. ",-1))])])):x("",!0),e("div",fe,[e("div",xe,[t[11]||(t[11]=e("p",{class:"text-xs text-gray-600 mb-1"},[e("strong",null,"What happens:"),f(" When a user sends a message, their message content will be automatically saved to the selected field. ")],-1)),t[12]||(t[12]=e("p",{class:"text-xs text-gray-500"},' Example: If user types "john@example.com" and you select "Email", their email will be updated to "john@example.com" ',-1)),a.config.target_field==="email"?(r(),d("p",be,[...t[10]||(t[10]=[e("strong",null,"Email validation:",-1),f(" If the user provides an invalid email format, they will receive the configured error message. ",-1)])])):x("",!0)])])])])])]),e("div",ye,[o(X,{modelValue:a.is_active,"onUpdate:modelValue":t[2]||(t[2]=l=>a.is_active=l),label:"Active",class:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"},null,8,["modelValue"])])]),e("div",{class:"flex justify-end space-x-3 mt-6"},[e("button",{type:"button",onClick:y,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"}," Cancel "),t[15]||(t[15]=e("button",{type:"submit",class:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors"}," Save Changes ",-1))])],32)])])):x("",!0)]))}},Me=ee(he,[["__scopeId","data-v-b80a6774"]]);export{Me as default};
